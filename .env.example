# ===========================================================================
# PhishGuard â€” Environment Configuration
# Copy this to .env and fill in your values
# ===========================================================================

# --- Environment ---
FLASK_ENV=development                # development | staging | production

# --- Flask ---
PHISH_SECRET=CHANGE_ME_TO_A_RANDOM_64_CHAR_HEX_STRING

# --- Database (PostgreSQL for production, SQLite for dev) ---
# Production:
DATABASE_URL=postgresql://phishguard:changeme@localhost:5432/phishguard
# Development fallback (leave empty to auto-use SQLite):
# DATABASE_URL=

# --- Redis ---
REDIS_URL=redis://localhost:6379/0

# --- Celery ---
CELERY_BROKER_URL=redis://localhost:6379/0
CELERY_RESULT_BACKEND=redis://localhost:6379/0

# --- S3 / MinIO file storage ---
S3_ENDPOINT_URL=http://localhost:9000
S3_ACCESS_KEY=minioadmin
S3_SECRET_KEY=minioadmin
S3_BUCKET=phishguard-uploads
S3_REGION=us-east-1

# --- OAuth 2.0: Google ---
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# --- OAuth 2.0: Microsoft ---
MICROSOFT_CLIENT_ID=
MICROSOFT_CLIENT_SECRET=
MICROSOFT_TENANT_ID=common

# --- JWT ---
JWT_SECRET_KEY=CHANGE_ME_TO_ANOTHER_RANDOM_64_CHAR_HEX_STRING
JWT_ACCESS_MINUTES=30
JWT_REFRESH_DAYS=7

# --- Session ---
SESSION_TIMEOUT_MINUTES=60

# --- Admin user (created on first startup) ---
ADMIN_EMAIL=admin@phishguard.local
ADMIN_PASSWORD=changeme

# --- VirusTotal ---
VT_API_KEY=

# --- Legacy API key auth (optional, alongside JWT) ---
PHISH_API_KEY=

# --- Rate limiting ---
RATELIMIT_DEFAULT=200 per hour
RATELIMIT_API_ANALYZE=30 per hour

# --- File size limit ---
MAX_FILE_SIZE=26214400

# --- Headless browser detonation (Playwright) ---
BROWSER_DETONATION_ENABLED=true
BROWSER_DETONATION_TIMEOUT=15000       # milliseconds
BROWSER_MAX_DETONATIONS=10             # max URLs to render per analysis

# --- YARA rule scanning ---
YARA_ENABLED=true
YARA_SCAN_TIMEOUT=30                   # seconds

# --- ML Classification ---
ML_CLASSIFIER_ENABLED=true             # sklearn phishing classifier

# --- NLP Body Analysis ---
NLP_ANALYSIS_ENABLED=true              # urgency/threat/impersonation detection

# --- HTML Similarity Analysis ---
HTML_SIMILARITY_ENABLED=true           # brand impersonation detection

# --- Threat Intelligence Feeds ---
THREAT_INTEL_ENABLED=false             # set true + add API keys below
ABUSEIPDB_API_KEY=                     # https://www.abuseipdb.com (free)
OTX_API_KEY=                           # https://otx.alienvault.com (free)
PHISHTANK_API_KEY=                     # https://phishtank.org (free, optional)

# --- SMTP Email Notifications ---
SMTP_HOST=                             # e.g. smtp.gmail.com
SMTP_PORT=587
SMTP_USER=
SMTP_PASS=
SMTP_FROM=noreply@phishguard.local
SMTP_USE_TLS=true

# --- Slack Notifications ---
SLACK_WEBHOOK_URL=                     # https://hooks.slack.com/services/...

# --- IMAP Email Forwarding ---
# Users forward suspicious emails to this inbox for automatic analysis
IMAP_HOST=                             # e.g. imap.gmail.com
IMAP_PORT=993
IMAP_USER=                             # e.g. analyze@yourcompany.com
IMAP_PASS=
IMAP_FOLDER=INBOX
IMAP_USE_SSL=true
IMAP_POLL_INTERVAL=60                  # seconds between polls
IMAP_AUTO_REPLY=true                   # reply with analysis results

# --- Application Base URL ---
APP_BASE_URL=http://127.0.0.1:5000

# --- PDF Report Branding ---
REPORT_COMPANY_NAME=PhishGuard            # Company name on cover/header/footer
REPORT_TLP_LEVEL=TLP:AMBER               # TLP:RED | TLP:AMBER | TLP:GREEN | TLP:CLEAR
REPORT_LOGO_PATH=                         # Absolute path to company logo (PNG/JPG, optional)
